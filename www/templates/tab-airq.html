<ion-view view-title="CO2" hide-nav-bar="true" cache-view="true">
    
    <ion-header-bar class="bar bar-header bar-positive">
      <h1 class="title">Qualit√† dell'aria</h1>
      <div class="buttons">
        <button class="button button-clear" ng-click="openModal()"><i class="icon ion-ios-help"></i></button>
      </div>
    </ion-header-bar>

    <ion-content>

        <ion-refresher on-refresh="refresh()" pulling-text="Pull to Refresh"></ion-refresher>

        <ion-list>

            <div>
                <p ng-show="view_error">
                    <i class="icon ion-alert-circled"></i> {{ error }}
                </p>
            </div>
            <!-- 
            <ion-item collection-repeat="airq in airqlist | orderBy: 'airq.aiq.level' : false | unique : 'polluting'">
            -->
            <ion-item collection-repeat="airq in airqlist | unique: ['polluting']">
                <div class="list card">
                    <div class="item item-avatar item-text-wrap">
                        <img ng-src=" {{ airq.item.aiq.level | level_image }}" />
                        <h2>{{ airq.item.city }} ({{ airq.item.location | distance }})</h2>
                        <h3>{{ airq.item.aiq.value | number : 1 }} {{ last | last }}, {{ airq.item.aiq.level | level_descr }}</h3>
                        <h4>Inquinamento di tipo {{ airq.item.aiq.type }}</h4>
                        <p>{{airq.item.polluting | polluting }}</p>
                    </div>

                    <div class="item item-body" align="center">
                    <h2>{{airq.item.polluting}}</h2> 
                    <h3>{{airq.item.aiq.realvalue | number : 1}} {{ airq.item.aiq.um }}</h2></h3>
                    <nvd3-bullet-chart
                            data="airq.meters"
                            margin="{left:0,top:10,bottom:10,right:0}"
                            height="160"
                            orient="top">
                            <svg></svg>
                    </nvd3-bullet-chart>
                    </div>

                    <div class="item tabs tabs-secondary tabs-icon-left">
                        <a class="tab-item" href="#/tab/airq/{{airq.item.polluting}}">
                          <i class="icon ion-ios-location"></i>
                          Mappa
                        </a>
                        <!--
                        <a class="tab-item" ng-click="stats(airq.item)">
                            <i class="icon ion-stats-bars"></i>
                            Stats
                        </a>
                        -->
                        <a class="tab-item" ng-click="share(airq.item)">
                            <i class="icon ion-share"></i>
                            Share
                        </a>
                    </div>          
                </div>
            </ion-item>
        </ion-list>
        <!--
        <ion-infinite-scroll on-infinite="refresh()" immediate-check="false"></ion-infinite-scroll>
        -->

  </ion-content>
  
</ion-view>
